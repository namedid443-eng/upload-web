<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Upload & Download - Render</title>
  <style>
    body{font-family: Arial, Helvetica, sans-serif; padding:20px;}
    h1{color:#2c3e50}
    .msg{color:green}
    .file-list{margin-top:20px}
    .file-item{margin-bottom:12px}
    video{max-width:600px; display:block; margin-top:8px;}
    .download{margin-left:8px}
  </style>
</head>
<body>
  <h1>Upload / Preview / Download</h1>
  {% if message %}
    <div class="msg">{{ message }}</div>
  {% endif %}

  <form method="post" enctype="multipart/form-data">
    <input type="file" name="file" required>
    <button type="submit">Upload</button>
  </form>

  <div class="file-list">
    <h2>Files on server</h2>
    {% if files|length == 0 %}
      <p>No files uploaded yet.</p>
    {% else %}
      <ul>
      {% for f in files %}
        <li class="file-item">
          {{ f.name }}
          <a class="download" href="{{ url_for('uploaded_file', filename=f.name) }}">[Download]</a>
          {% if f.is_video %}
            <div>
              <video controls preload="none" width="480">
                <source src="{{ url_for('play_file', filename=f.name) }}" type="video/mp4">
                Your browser does not support HTML5 video.
              </video>
            </div>
          {% endif %}
        </li>
      {% endfor %}
      </ul>
    {% endif %}
  </div>
</body>
</html>
